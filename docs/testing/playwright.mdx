---
title: Testing with Playwright
description: Use Playwright to write end-to-end tests with Clerk.
---

Playwright is a well-established JavaScript testing framework. This guide aims to help you set up your environment for creating authenticated tests with Clerk. This guide will assume you're somewhat familiar with Clerk and Playwright.

> [!IMPORTANT]
> Check out the [demo repo](https://github.com/clerk/clerk-playwright-nextjs) that tests a Clerk-powered application using [Testing Tokens](/docs/testing/overview#testing-tokens).

<Steps>
  ### Install `@clerk/testing`

  Clerk's testing package provides integration helpers for popular testing frameworks. Install it by running the following command:

  <CodeBlockTabs options={['npm', 'yarn', 'pnpm']}>
    ```sh {{ filename: 'terminal' }}
    npm i @clerk/testing --save-dev
    ```

    ```sh {{ filename: 'terminal' }}
    yarn add -D @clerk/testing
    ```

    ```sh {{ filename: 'terminal' }}
    pnpm add @clerk/testing -D
    ```
  </CodeBlockTabs>

  ### Set your API keys

  In your test runner, set your publishable and secret key as the `CLERK_PUBLISHABLE_KEY` and `CLERK_SECRET_KEY` environment variables, respectively.

  To find your keys:

  1. Navigate to the [Clerk Dashboard](https://dashboard.clerk.com/last-active?path=api-keys).
  1. In the navigation sidebar, select **API Keys**.
  1. In the **Quick Copy** section, copy your Clerk publishable and secret key.

  > [!WARNING]
  > Ensure you provide the secret key in a secure manner, to avoid leaking it to third parties. For example, if you are using GitHub Actions, refer to [_Using secrets in GitHub Actions_](https://docs.github.com/en/actions/security-guides/using-secrets-in-github-actions).

  ### Global setup

  To set up Clerk with Playwright, you must call the `clerkSetup()` function in your [global setup file](https://playwright.dev/docs/test-global-setup-teardown).

  ```tsx {{ filename: 'global-setup.ts' }}
  import { clerkSetup } from '@clerk/testing/playwright'
  import { test as setup } from '@playwright/test'

  setup('global setup', async ({}) => {
    await clerkSetup()
  })
  ```

  `clerkSetup` will obtain a [Testing Token](/docs/testing/overview#testing-tokens) when your test suite starts, making it available for all subsequent tests to use.

  > [!NOTE]
  > You can set the Testing Token yourself as opposed to calling `clerkSetup`, by
  > setting it in the `CLERK_TESTING_TOKEN` environment variable.

  ### Use `setupClerkTestingToken`

  Now that Playwright is configured with Clerk, you can use the `setupClerkTestingToken()` function in your tests to augment them with the Testing Token. See the following example:

  ```tsx {{ filename: 'my-test.spec.ts' }}
  import { setupClerkTestingToken } from '@clerk/testing/playwright'
  import { test } from '@playwright/test'

  test('sign up', async ({ page }) => {
    await setupClerkTestingToken({ page })

    await page.goto('/sign-up')
    // ...
  })
  ```
</Steps>

## Test Helpers

The `@clerk/testing` package also provides some helper functions to sign in/sign out with Clerk in your Playwright tests without having to interact with the UI.
To use these commands, import the `clerk` object from the `@clerk/testing/playwright` package.

### `clerk.signIn`

The `clerk.signIn()` function is used to sign in a user using Clerk. This helper supports only the following first factor strategies:

- Password
- Phone code
- Email code

Multi-factor authentication is not supported.

> [!NOTE]
> `clerk.signIn()` internally uses the `setupClerkTestingToken()` helper, so you don't need to call it separately.

#### Prerequisites

- Before calling this function, you must call `page.goto`.
- Before using this function, navigate to a non-protected page that loads Clerk.

#### Parameters

`clerk.signIn` accepts an object with the following properties:

<Properties>
  - `page`
  - `Object`

  The Playwright page object to use for the sign-in operation.

  ---

  - `signInParams.strategy`
  - `'password' | 'phone_code' | 'email_code'`

  The sign-in strategy. Supported strategies are:

  - `password`: The command will sign in the user using the provided password and identifier.
  - `phone_code`: You must have a user with a test phone number as an identifier (e.g., `+15555550100`).
  - `email_code`: You must have a user with a test email as an identifier (e.g., `your_email+clerk_test@example.com`).

  ---

  - `signInParams.identifier`
  - `string`

  The user's identifier. This could be a username, a phone number, or an email.

  ---

  - `signInParams.password`
  - `string`

  The user's password. This is required only if the `strategy` is set to `'password'`.

  ---

  - `setupClerkTestingTokenOptions?`
  - `Object`

  Options to pass to the `setupClerkTestingToken` function. Optional.
</Properties>

#### Example

The following example demonstrates how to use the `clerk.signIn` helper function in a test to sign in a user.

```ts {{ filename: 'e2e/app.spec.ts' }}
import { clerk } from '@clerk/testing/playwright'

test('sign in', async ({ page }) => {
  await page.goto('/')
  await clerk.signIn({
    page,
    signInParams: { strategy: 'phone_code', identifier: '+15555550100' },
  })
  await page.goto('/protected')
})
```

### `clerk.signOut`

The `clerk.signOut` function is used to sign out the current user using Clerk.

#### Prerequisites

- Before calling this function, yu must call `page.goto`.
- Before using this function, navigate to a page that loads Clerk.

#### Parameters

`clerk.signOut` accepts an object with the following properties:

<Properties>
  - `page`
  - `Object`

  The Playwright page object to use for the sign-in operation.

  ---

  - `signOutOptions.sessionId?`
  - `string`

  The ID of a specific session to sign out of. Useful for multi-session applications.

  ---

  - `signOutOptions.redirectUrl?`
  - `string`

  The redirect URL to navigate to after sign out is complete.
</Properties>

#### Example

The following example demonstrates how to use the `clerk.signOut` helper in a test to sign a user out.

```ts {{ filename: 'e2e/app.spec.ts' }}
import { clerk } from '@clerk/testing/playwright'

test('sign out', async ({ page }) => {
  await page.goto('/')
  await clerk.signIn({
    page,
    signInParams: { strategy: 'phone_code', identifier: '+15555550100' },
  })
  await page.goto('/protected')
  await clerk.signOut({ page })
  await page.goto('/protected')
  // should redirect to sign in page
})
```

### `clerk.loaded`

The `clerk.loaded` function asserts that Clerk has been loaded.

#### Prerequisites

- Before calling this command, you must call `page.goto`.
- Before using this command, navigate to a page that loads Clerk.

#### Parameters

`clerk.loaded` accepts an object with the following properties:

<Properties>
  - `page`
  - `Object`

  The Playwright page object to use for the sign-in operation.
</Properties>

#### Example

The following example demonstrates how to use the `clerk.loaded` helper in a test to assert that Clerk has been loaded.

```ts {{ filename: 'e2e/app.spec.ts' }}
import { clerk } from '@clerk/testing/playwright'

test('ensure that clerk has loaded', async ({ page }) => {
  await page.goto('/')
  await clerk.loaded({ page })
  // clerk has loaded
})
```

For more information, feedback or issues, visit the [`@clerk/testing`](https://github.com/clerk/javascript/tree/main/packages/testing) package.
